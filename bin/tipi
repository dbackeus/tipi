#!/usr/bin/env ruby

require File.expand_path('../lib/tipi', __dir__)
require File.expand_path('../lib/tipi/rack_adapter', __dir__)

app_path = ARGV.first || './config.ru'
app = Tipi::RackAdapter.load(app_path)
opts = { reuse_addr: true, dont_linger: true }

puts "listening on port 1234"
puts "pid: #{Process.pid}"
Tipi.serve('0.0.0.0', 1234, opts, &app)
